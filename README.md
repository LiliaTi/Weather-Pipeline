# Weather Data ETL Pipeline

![Python](https://img.shields.io/badge/python-3.9+-blue.svg)
![TimescaleDB](https://img.shields.io/badge/TimescaleDB-2.0+-blue.svg)
![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?logo=docker&logoColor=white)

ETL-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ—Ç–µ–æ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:

- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö**:
  - JSON-—Ñ–∞–π–ª—ã
  - API Open-Meteo

- **–ü—Ä–∏—ë–º–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö**:
  - CSV-—Ñ–∞–π–ª—ã
  - TimescaleDB

> –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –æ—Ç–±–æ—Ä–∞ –≤ –ø—Ä–æ–µ–∫—Ç **–®–ò–§–¢ (Data Engineering)**

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö**: JSON-—Ñ–∞–π–ª—ã –∏ Open-Meteo API
- **–ì–∏–±–∫–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–≥—Ä—É–∑–∫–∏**: CSV –∏–ª–∏ TimescaleDB
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤**: —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –º–µ—Ç–µ–æ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–ø–∏—Å–µ–π
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Docker

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### TimescaleDB –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤

–î–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ –ø–æ —Å–≤–æ–µ–π –ø—Ä–∏—Ä–æ–¥–µ —è–≤–ª—è—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏, –ø–æ—ç—Ç–æ–º—É —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ TimescaleDB —Å:

- –ì–∏–ø–µ—Ä—Ç–∞–±–ª–∏—Ü–∞–º–∏ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è 7 –¥–Ω–µ–π (–¥–ª—è –Ω–µ–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤)
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º –ø–æ –ø–æ–ª—é `datetime` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º –∏ –≥–∞—Ä–∞–Ω—Ç–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø–∏—Å–µ–π
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤

–Ø –≤—ã–±—Ä–∞–ª–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: ON CONFLICT DO NOTHING –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—á–∏–Ω–∞–º:
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å (–≤—Ä—è–¥ –ª–∏ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã, —Å–∫–æ—Ä–µ–µ –º—ã –∑–∞—Ö–æ—Ç–∏–º —É–∑–Ω–∞—Ç—å —Å–±—ã–ª—Å—è –ø—Ä–æ–≥–Ω–æ–∑ –∏–ª–∏ –Ω–µ—Ç)
- ON CONFLICT –¥–µ–ª–∞–µ—Ç 1 –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ 2 ‚Äî –ë–î —Å–∞–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω–¥–µ–∫—Å–∞
- –ü—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ TimescaleDB –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å—é —Ç–∞–±–ª–∏—Ü—É, –∞ –∏—â–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∏–Ω–¥–µ–∫—Å—É datetime
- –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ –¥–∞–∂–µ –ø—Ä–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
weather-etl/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input/          # –í—Ö–æ–¥–Ω—ã–µ JSON-—Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ output/         # –í—ã—Ö–æ–¥–Ω—ã–µ CSV-—Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ constants.py        # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ validators.py       # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ api_client.py       # –ö–ª–∏–µ–Ω—Ç Open-Meteo API
‚îÇ   ‚îú‚îÄ‚îÄ transformations.py  # –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ storage/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ csv_writer.py   # –ó–∞–ø–∏—Å—å –≤ CSV
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ db_writer.py   # –ó–∞–ø–∏—Å—å –≤ TimescaleDB
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ tests/                  # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ run_tests.py            # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ .gitignore
```

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª

2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã):
```ini
# TimescaleDB
POSTGRES_USER=admin
POSTGRES_PASSWORD=password
POSTGRES_HOST=timescaledb
POSTGRES_PORT=5432
POSTGRES_DB=mydb
PGADMIN_DEFAULT_EMAIL=admin@example.com
PGADMIN_DEFAULT_PASSWORD=your_password

## üèÉ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

1. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```bash
docker-compose up -d --build
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```bash
docker ps
```

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
docker exec -it <CONTAINER_NAME> python /app/run_tests.py
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ JSON-—Ñ–∞–π–ª–æ–≤
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –≤ TimescaleDB
docker exec <CONTAINER_NAME> python main.py json_to_db

# –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
docker exec <CONTAINER_NAME> python main.py json_to_csv
```

### –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –∏–∑ API
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –≤ TimescaleDB (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–∞—Ç)
docker exec <CONTAINER_NAME> python main.py api_to_db \
  --start-date <YYYY-MM-DD> --end-date <YYYY-MM-DD>

# –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–∞—Ç)
docker exec <CONTAINER_NAME> python main.py api_to_csv \
  --start-date <YYYY-MM-DD> --end-date <YYYY-MM-DD>
```



